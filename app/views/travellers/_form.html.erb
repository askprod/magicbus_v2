  <div class="card login-form">
        
    <h1 class="card-header adventpro yellow text-center display-5">Add a Traveller</h1>

    <div class="card-body">
      <div id="close-button">
    </div>

        <%= form_with(model: traveller, remote: true) do |form| %>

          <div class="container">

              <p class="h3 my-auto text-center">Would this Traveller like to subscribe to the <b>Travel Insurance</b>?</p>
              <p class="small my-auto text-center">Travel insurance quick explanation..</p>
            
            <div class="btn-group-toggle row no-gutters justify-content-center">
              <div class="col-sm-2 m-2">
                <%= form.label :insurance, "Yes", id:"yes-btn", class:"btn btn-block btn-secondary", for: "traveller_insurance_status_true" %>
                <%= form.radio_button :insurance_status, true, class: "d-none" %>
              </div>

              <div class="col-sm-2 m-2">
                <%= form.label :insurance, "No", id:"no-btn", class:"btn btn-block btn-secondary", for: "traveller_insurance_status_false"  %>
                <%= form.radio_button :insurance_status, false, class: "d-none" %>
              </div>
            </div>

            <line/>

            <div class="row justify-content-center">
              <div class="col-sm-4 form-group text-center">
                <%= form.label "Gender", class: "small" %>
                <%= form.select :gender, ['Male', 'Female'], {include_blank: "Select"}, class: "form-control rounded border" %>
              </div>
            </div>

            <%= form.hidden_field :cart_id, :value => @current_user.cart.id %>

            <div class="row">
              <div class="col-sm form-group">
                <%= form.label "First Name", class: "small" %>
                <%= form.text_field :first_name, class: "form-control rounded border" %>
              </div>

              <div class="col-sm form-group">
                <%= form.label "Last Name", class: "small" %>
                <%= form.text_field :last_name, class: "form-control rounded border" %>
              </div>
            </div>

            <div class="row">
              <div class="col-sm form-group">
                <%= form.label "Email", class: "small" %>
                <%= form.text_field :email_address, class: "form-control rounded border" %>
              </div>
              
              <div class="col-sm form-group">
                <%= form.label "Address", class: "small" %>
                <%= form.text_field :address, class: "form-control rounded border" %>
              </div>
            </div>

            <div class="row">
              <div class="col-sm form-group">
                <%= form.label "ZIP Code", class: "small" %>
                <%= form.text_field :zip_code, class: "form-control rounded border" %>  
              </div>

              <div class="col-sm form-group">  
                <%= form.label "Birth Date", class: "small" %>
                <%= form.date_field :birth_date, class: "form-control rounded border" %>
              </div>
            </div>

            <div class="row">
              <div class="col-sm form-group">
                <%= form.label "Nationality", class: "small" %>
                <%= form.select :nationality, @nationalities_list.collect {|p| p }, {include_blank: "Select"}, class: "form-control rounded border" %>
              </div>

              <div class="col-sm form-group">
                <%= form.label "Phone", class: "small" %>
                <br>
                <%= form.telephone_field :phone_number, class: "form-control rounded border" %>
              </div>
            </div>

            <line/>

            <div class="text-center">
              <p class="small">To help us organize meals during your trip, please fill in the next forms accordingly. We will take everything into account while cooking.
              <br>
              Please note that in the case of Vegan diets, we will not provide meals throughout the duration of the trips.
              <br>
              We will deduct 30â‚¬ per vegan traveller.</p>
            </div>

            <div class="row">

              <div class="col-sm-6 text-center">
                <%= form.label "Food Diets", class: "small" %>
                <%= form.select :food_diet_ids, @food_diets_list.collect {|p| [p.name, p.id] }, {include_blank: "None"}, class: "form-control rounded border" %>

                <div id='food_diets'>
                  <%= form.fields_for :food_diets do |ff| %>
                    <%= render 'food_diet_fields', :f => ff %>
                  <% end %>
                  <div class='links' style='display: none;'>
                    <%= link_to_add_association 'Add', form, :food_diets, class: "btn btn-stylised adventpro my-2" %>
                  </div>
                </div>
                
              </div> 
            
              <div class="col-sm-6 text-center">
                <%= form.label "Food Allergies", class: "small" %>
                <%= form.select :food_restriction_ids, @food_restrictions_list.collect {|p| [p.name, p.id] }, {include_blank: "None"}, class: "form-control rounded border" %>

                <div id='food_restrictions'>
                  <%= form.fields_for :food_restrictions do |ff| %>
                    <%= render 'food_restriction_fields', :f => ff %>
                  <% end %>
                  <div class='links' style='display: none;'>
                    <%= link_to_add_association 'Add', form, :food_restrictions, class: "btn btn-stylised adventpro my-2" %>
                  </div>
                </div>

              </div> 

            </div>

            <line/>

            <div class="actions">
              <%= form.submit "Save Traveller", class: "mb-3 btn btn-lg btn-stylised btn-block adventpro" %>
            </div>
          </div>

    </div>
  </div>

<% end %>

<script>
$( document ).ready(function() {
    if ($("#traveller_food_diet_ids :selected").text() == 'Other') {
        $('#food_diets .links').show();
    }
    else 
      $('#food_diets .links').hide(); 
      $('#food_diets .nested-fields').remove();
});

$( document ).ready(function() {
    if ($("#traveller_food_restriction_ids :selected").text() == 'Other') {
        $('#food_restrictions .links').show();
    }
    else 
      $('#food_restrictions .links').hide(); 
      $('#food_restrictions .nested-fields').remove();
});

$('#traveller_food_restriction_ids').change(function() {
    if ($("#traveller_food_restriction_ids :selected").text() == 'Other') {
        $('#food_restrictions .links').show();
    }
    else 
      $('#food_restrictions .links').hide(); 
      $('#food_restrictions .nested-fields').remove();
});

$('#traveller_food_diet_ids').change(function() {
    if ($("#traveller_food_diet_ids :selected").text() == 'Other') {
        $('#food_diets .links').show();
    }
    else 
      $('#food_diets .links').hide(); 
      $('#food_diets .nested-fields').remove();
});

$(document).ready(function(){
  $(".btn-group-toggle input[type=radio]").change(function(){
    if ($(".btn-group-toggle input[type='radio']:checked").val() == "true") {
      $("#yes-btn").addClass('btn-success');
      $("#no-btn").removeClass('btn-danger');
    } else if ($(".btn-group-toggle input[type='radio']:checked").val() == "false") {
      $("#yes-btn").removeClass('btn-success');
      $("#no-btn").addClass('btn-danger');
      }
  });
});
</script>

<script>
$("#traveller_phone_number").intlTelInput({
    formatOnInit: true,
    separateDialCode: true,
});

$("form").submit(function() {
    $("#traveller_phone_number").val($("#traveller_phone_number").intlTelInput("getNumber"));
});
</script>


